KISSY.add('kg/wf/2.0.0/index',["./lib/base","./lib/loader"],function(S ,require, exports, module) {var e=require("./lib/base"),r=require("./lib/loader");e.Loader=r,module.exports=e;});KISSY.add('kg/wf/2.0.0/lib/base',["node","base"],function(S ,require, exports, module) {function t(){var e=this;t.superclass.constructor.apply(e,arguments);var r=e.__onResize=S.buffer(a,u,e);a.call(e),c(o).on("resize",r)}function e(t,e,a,r){function i(){s=[].concat(S.makeArray(t)),s.length>0?!function(){var i=+new Date;do{var l=s.shift();e.call(a,l)}while(s.length>0&&+new Date-i<50);s.length>0?n=setTimeout(arguments.callee,25):r&&r.call(a,t)}():r&&r.call(a,t)}var n,s,l={};return l.stop=function(){n&&(clearTimeout(n),s=[],t.each(function(t){t.stop()}))},l.start=i,l}function a(){var t=this,e=t.get("colWidth"),a=t.get("container"),r=t._containerRegion||{};S.isFunction(e)&&(e=e(t)),!a[0].offsetWidth||t._colWidth===e&&a.width()===r.width||(t._colWidth=e,t.adjust())}function r(){var t=this,e=t.get("container"),a=e.width(),r=t._curColHeights||[];t._curColHeights=r,r.length=Math.max(Math.floor(a/t._colWidth),t.get("minColCount")),t._containerRegion={width:a},S.each(r,function(t,e){r[e]=0}),t._colItems=[]}function i(t,e,a,r){function i(e){f[_]+=o.outerHeight(!0);var a=t._colItems;a[_]=a[_]||[],a[_].push(o),o.attr("data-waterfall-col",_);var i=o[0].className.replace(/\s*ks-waterfall-col-(?:first|last|\d+)/g,"");i+=" ks-waterfall-col-"+_,0==_?i+=" ks-waterfall-col-first":_==f.length-1&&(i+=" ks-waterfall-col-last"),o[0].className=i,e||r&&r()}var n,s,l=t.get("effect"),o=c(a),u=t.get("align"),f=t._curColHeights,d=t.get("container"),h=t._colWidth,g=f.length,_=0,p=t._containerRegion,v=Number.MAX_VALUE;if(!g)return void 0;if(o.hasClass("ks-waterfall-fixed-left"))_=0;else if(o.hasClass("ks-waterfall-fixed-right"))_=g>0?g-1:0;else for(var m=0;g>m;m++)f[m]<v&&(v=f[m],_=m);if(n="left"===u?0:Math.max(p.width-g*h,0),"center"===u&&(n/=2),"justify"===u&&g>1&&(n=_>0?Math.max((p.width-h)/(g-1)-h,0)*_:0),s={left:_*h+n,top:f[_]},e)o.css(s),l&&l.effect&&o.css("visibility","hidden"),d.append(o),i();else{var j=t.get("adjustEffect");j?(i(1),o.animate(s,j.duration,j.easing,r)):(o.css(s),i())}return o}function n(t){var e=this,a=i(e,!0,t),r=e.get("effect");a&&r&&r.effect&&(a.hide(),a.css("visibility",""),a[r.effect](r.duration,0,r.easing))}var s=require("node"),l=require("base"),c=s.all,o=S.Env.host,u=50;t.ATTRS={container:{setter:function(t){return c(t)}},align:{value:"center"},minColCount:{value:1},effect:{value:{effect:"fadeIn",duration:1}},colWidth:{},adjustEffect:{}},S.extend(t,l,{isAdjusting:function(){return!!this._adjuster},isAdding:function(){return!!this._adder},adjustItem:function(t,a){function r(){p--,0>=p&&(i._adjuster=0,a.callback&&a.callback.call(i))}var i=this;if(a=a||{},i.isAdjusting())return void 0;var n,s=t.outerHeight(!0);a.process&&(n=a.process.call(i)),void 0===n&&(n=t.outerHeight(!0));for(var l,c=n-s,o=i._curColHeights,u=parseInt(t.attr("data-waterfall-col")),f=i._colItems[u],d=[],h=Math.max.apply(Math,o),g=0;g<f.length&&f[g][0]!==t[0];g++);for(g++;g<f.length;)d.push(f[g]),g++;o[u]+=c,l=Math.max.apply(Math,o),l!=h&&i.get("container").height(l);var _=a.effect,p=d.length;return p?(void 0===_&&(_=i.get("adjustEffect")),i._adjuster=e(d,function(t){_?t.animate({top:parseInt(t.css("top"))+c},_.duration,_.easing,r):(t.css("top",parseInt(t.css("top"))+c),r())}),i._adjuster.start(),i._adjuster):a.callback&&a.callback.call(i)},removeItem:function(t,e){e=e||{};var a=this,r=e.callback;a.adjustItem(t,S.mix(e,{process:function(){return t.remove(),0},callback:function(){for(var e=parseInt(t.attr("data-waterfall-col")),i=a._colItems[e],n=0;n<i.length;n++)if(i[n][0]==t[0]){i.splice(n,1);break}r&&r()}}))},adjust:function(t){function a(){l--,0>=l&&(n.get("container").height(Math.max.apply(Math,n._curColHeights)),n._adjuster=0,t&&t.call(n),n.fire("adjustComplete",{items:s}))}S.log("waterfall:adjust");var n=this,s=n.get("container").all(".ks-waterfall");n.isAdjusting()&&(n._adjuster.stop(),n._adjuster=0),r.call(n);var l=s.length;return l?(n._adjuster=e(s,function(t){i(n,!1,t,a)}),n._adjuster.start(),n._adjuster):t&&t.call(n)},addItems:function(t,a){var r=this;return r._adder=e(t,n,r,function(){r.get("container").height(Math.max.apply(Math,r._curColHeights)),r._adder=0,a&&a.call(r),r.fire("addComplete",{items:t})}),r._adder.start(),r._adder},destroy:function(){var t=this,e=t.__onResize;c(o).detach("resize",e),e.stop(),S.log("waterfall is destroyed!"),t.fire("destroy"),t.__destroyed=1}}),module.exports=t;});KISSY.add('kg/wf/2.0.0/lib/loader',["node","./base"],function(S ,require, exports, module) {function t(){var n=this;t.superclass.constructor.apply(n,arguments),n.__onScroll=S.buffer(o,s,n),n.start()}function o(){var t=this;if(S.log("waterfall:doScroll"),!t.__loading){if(t.isAdjusting())return void t.__onScroll();var o=t.get("container");if(o[0].offsetWidth){var e=o.offset().top,r=t.get("diff"),s=t._curColHeights;s.length&&(e+=Math.min.apply(Math,s)),r+l(a).scrollTop()+l(a).height()>=e&&(S.log("waterfall:loading"),n.call(t))}}}function n(){function t(t,n){e.__loading=0,e.addItems(t,function(){n&&n.apply(this,arguments),o.call(e)})}function n(){e.end()}{var e=this;e.get("container")}e.__loading=1;var r=e.get("load");r&&r(t,n)}var e=require("node"),r=require("./base"),l=e.all,a=S.Env.host,s=50;t.ATTRS={diff:{value:0}},S.extend(t,r,{start:function(){this.resume()},end:function(){this.pause()},pause:function(){var t=this;t.__destroyed||(l(a).detach("scroll",t.__onScroll),t.__onScroll.stop())},resume:function(){var t=this;t.__destroyed||(l(a).on("scroll",t.__onScroll),t.__started=1,o.call(t))},destroy:function(){var o=this;o.end(),t.superclass.destroy.apply(o,arguments)}}),module.exports=t;});